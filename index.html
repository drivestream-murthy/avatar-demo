<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Avatar Demo — Click-Safe</title>
    <!-- Silence favicon 404 -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>">
    <style>
      :root { --w: 420px; }
      * { box-sizing: border-box; }
      body {
        font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
        background:#0f1115; color:#eaeef5; display:flex; justify-content:center; padding:16px;
      }
      #app { width:min(100%, var(--w)); position: relative; z-index: 0; }

      #stage {
        width:100%; aspect-ratio:9/16; background:#161b22; border-radius:16px;
        overflow:hidden; position:relative; box-shadow:0 8px 30px rgba(0,0,0,.35);
      }

      /* Fill stage */
      #avatarVideo, #avatarCanvas { position:absolute; inset:0; }

      /* Make raw video visible; keep canvas hidden while debugging */
      #avatarVideo { opacity:1 !important; z-index:2; }
      #avatarCanvas { display:none; z-index:1; pointer-events:none; }

      #controls {
        margin-top:10px; display:flex; gap:8px; position: relative; z-index: 10;
        pointer-events: auto;
      }
      button {
        padding:10px 12px; border-radius:10px; border:1px solid #2a2f3a;
        background:#151a28; color:#eaeef5; cursor:pointer;
      }
      button:hover { background:#1c2336; }

      #banner {
        display:none; margin-top:10px; padding:10px; border-radius:10px;
        background:#2b132a; border:1px solid #6a2a67; color:#ffd3e6; font-size:14px; white-space:pre-wrap;
      }
      #banner.show { display:block; }

      #log {
        margin-top:10px; font-family:ui-monospace, Menlo, Consolas, monospace; font-size:12px;
        background:#0b0e14; color:#c9d1d9; padding:10px; border-radius:10px; border:1px solid #2a2f3a;
        height:180px; overflow:auto;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <h1>Avatar Demo — Click-Safe</h1>
      <p style="opacity:.75;font-size:12px;margin-top:-6px">
        Click Start once. If the button still doesn’t react, open DevTools and run <code>window._start()</code>.
      </p>

      <div id="stage">
        <!-- IMPORTANT: no "muted" attribute -->
        <video id="avatarVideo" playsinline autoplay></video>
        <canvas id="avatarCanvas"></canvas>
      </div>

      <div id="controls">
        <!-- Inline onclick: guaranteed to fire even if listeners are blocked -->
        <button id="sessionFab" onclick="window._start()">▶ Start</button>
        <button id="resetBtn"   onclick="window._stop()">■ Stop</button>
      </div>

      <div id="banner"></div>
      <div id="log"></div>
    </div>

    <!-- Vite will rewrite this to /assets/*.js in production build -->
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
